(function(d,c,a,e){var b=function(g,f){this._init()};b.prototype={constructor:b,_init:function(){d("#listarDescargas").bind("click",{scope:this},function(f){f.data.scope.listar()})},listar:function(){d("#alertError").hide();var j=d("#listarDescargas");j.toggleClass("active");var k=d("#nif_empresa").val();var i=d("#proce option:selected").val();var m=d("#desEstado option:selected").val();var l;var g;var f=this;try{d.ajax({url:localStorage.getItem(localStorage.getItem("entorno"))+"ficheros/v1/consultar?idProcedimiento="+i+"&nifEmpresa="+k+"&estado="+m,type:"POST",dataType:"json",contentType:"application/json",success:function(n,o){console.log("consultar ok");f.recorreRespuesta(n)},error:function(o,n){d.fn.error("Error en la peticion",o.responseText);j.toggleClass("active")},cache:false})}catch(h){alert(h)}},recorreRespuesta:function(j){var t=this;var s=d("#descargaTable");d(".item-descarga").remove();var k=j.length-1;for(k;k>=0;k--){var r=j[k];var n=a.createElement("tr");n.id="des-"+r.uuid;var h=a.createElement("td");h.id="num-"+r.uuid;h.innerHTML=k+1;n.appendChild(h);var g=a.createElement("td");g.innerHTML=r.nombre;n.appendChild(g);var f=a.createElement("td");f.innerHTML=filesize(r.numeroBytes);n.appendChild(f);var p=a.createElement("td");p.innerHTML=r.fechaDisponibilidad?(new Date(r.fechaDisponibilidad+" UTC")).toLocaleString():"";n.appendChild(p);var m=a.createElement("td");m.innerHTML=r.fechaCaducidad?(new Date(r.fechaCaducidad+" UTC")).toLocaleString():"";n.appendChild(m);var u=a.createElement("td");u.innerHTML=r.tipoFichero;n.appendChild(u);var o=a.createElement("td");o.innerHTML=r.estado;n.appendChild(o);var q=a.createElement("td");q.appendChild(t.createADown(r.uriDescargas));n.appendChild(q);n.className="item-descarga";s.append(n)}var l=d("#listarDescargas");l.toggleClass("active")},createADown:function(h){var f=a.createElement("a");f.setAttribute("href",h);var g=a.createElement("span");g.className="fa fa-download";f.appendChild(g);return f}};d.fn.listarDescargas=function(g){var f=Array.apply(null,arguments);f.shift();return this.each(function(){var j=d(this),i=j.data("listarDescargas"),h=typeof g==="object"&&g;if(!i){j.data("listarDescargas",(i=new b(this,d.extend({},d.fn.listarDescargas.defaults,h,d(this).data()))))}if(typeof g==="string"){i[g].apply(i,f)}})};d.fn.listarDescargas.defaults={};d.fn.listarDescargas.Constructor=b})(jQuery,window,document);